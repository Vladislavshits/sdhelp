#!/bin/bash

# Скрипт запуска sdhelp с логированием
cd "$HOME"/sdhelp

# Проверка существования директории
if [ ! -d "venv" ]; then
    echo "Виртуальное окружение не найдено. Запустите install.sh сначала."
    exit 1
fi

# Создание папки для логов если не существует
mkdir -p logs

# Создание файла лога с временной меткой
LOG_FILE="logs/sdhelp_$(date +%Y%m%d_%H%M%S).log"

echo "=== Запуск SD Help $(date) ===" >> "$LOG_FILE"

# Активация виртуального окружения
echo "Активация виртуального окружения..." >> "$LOG_FILE"
source venv/bin/activate

# Запуск основной программы из папки app с логированием
echo "Запуск основной программы..." >> "$LOG_FILE"
cd app

# Запуск с перенаправлением вывода в лог и на консоль
python sdhelp.py 2>&1 | tee -a "../$LOG_FILE"

# Запись времени завершения
echo "=== Завершение SD Help $(date) ===" >> "../$LOG_FILE"
